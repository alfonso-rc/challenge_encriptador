<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Encriptador de textos</title>
	</head>
	<body>
		<header>
			<img src="./encriptador/Logo.png" alt="Logo alura" />
		</header>

		<h1>Encriptación y desencriptación</h1>

		<label>
			<input type="radio" name="action" value="encrypt" checked />
			Encriptar
		</label>

		<label>
			<input type="radio" name="action" value="decrypt" />
			Desencriptar
		</label>

		<br /><br />

		<label>
			Texto:
			<input type="text" id="input" />
		</label>

		<br /><br />

		<button onclick="process()">Procesar</button>

		<br /><br />

		<label>
			Resultado:
			<input type="text" id="output" />
		</label>

		<br /><br />

		<button onclick="copy()">Copiar</button>

		<script>
			const keys = {
				a: "ai",
				e: "enter",
				i: "imes",
				o: "ober",
				u: "ufat",
			};

			function process() {
				const input = document.getElementById("input").value;
				const action = document.querySelector('input[name="action"]:checked').value;

				let output = "";

				if (action === "encrypt") {
					output = encrypt(input);
				} else if (action === "decrypt") {
					output = decrypt(input);
				}

				document.getElementById("output").value = output;
			}

			function encrypt(text) {
				let result = "";

				for (let i = 0; i < text.length; i++) {
					const char = text.charAt(i);

					if (keys[char]) {
						result += keys[char];
					} else {
						result += char;
					}
				}

				return result;
			}

			function decrypt(text) {
				const keysArray = Object.entries(keys);

				// Variable para guardar los resultados de cada búsqueda de palabras clave
				let result = text;

				// Itera el array con las [llave, valor]
				keysArray.forEach(([key, value]) => {
					// Se crea una expresión regular para buscar la palabra en toda la oración
					// No importa en ella hay 2 palabras clave, que las va a localizar
					const regex = new RegExp(value, "g");

					// Busca las palabras con el regex, y las remplaza por la llave
					// O sea la letra original
					result = result.replace(regex, key);
				});

				// Retorna el resultado xD
				return result;
			}

			function copy() {
				const output = document.getElementById("output");

				output.select();
				output.setSelectionRange(0, 99999);

				document.execCommand("copy");
			}
		</script>
	</body>
</html>
